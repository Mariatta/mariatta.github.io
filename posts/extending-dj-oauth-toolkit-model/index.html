<!doctype html><html lang=en><head><title>Extending the Django OAuth Toolkit Application Model Mid-project</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.39267c23958d14feba93d7b8496823aec39e7d5df2051059b54120df6247d76c.css integrity="sha256-OSZ8I5WNFP66k9e4SWgjrsOefV3yBRBZtUEg32JH12w="><meta property="og:url" content="https://mariatta.ca/posts/extending-dj-oauth-toolkit-model/"><meta property="og:site_name" content="Mariatta"><meta property="og:title" content="Extending the Django OAuth Toolkit Application Model Mid-project"><meta property="og:description" content="Django Oauth Toolkit The Django Oauth Toolkit is a powerful library for adding OAuth2 functionalities out of the box for your Django app. The library comes with pre-defined models, views, urls, and templates for managing OAuth2 authorization and flow.
The Application Model Django OAuth Toolkit provides a basic model for the OAuth2 Application, this is a model that represents a Client on the Authorization server. It has fields like client_id, user, redirect_uris, client_secret, etc."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-30T00:00:00-08:00"><meta property="article:modified_time" content="2024-08-30T00:00:00-08:00"><meta property="article:tag" content="Python"><meta property="article:tag" content="Django"><meta property="article:tag" content="Third Party Libraries"><meta property="article:tag" content="Learnings"><meta property="article:tag" content="Errors"><meta property="article:tag" content="ORM"><meta property="og:image" content="https://mariatta.ca/images/posts/sep2020.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mariatta.ca/images/posts/sep2020.jpg"><meta name=twitter:title content="Extending the Django OAuth Toolkit Application Model Mid-project"><meta name=twitter:description content="Django Oauth Toolkit The Django Oauth Toolkit is a powerful library for adding OAuth2 functionalities out of the box for your Django app. The library comes with pre-defined models, views, urls, and templates for managing OAuth2 authorization and flow.
The Application Model Django OAuth Toolkit provides a basic model for the OAuth2 Application, this is a model that represents a Client on the Authorization server. It has fields like client_id, user, redirect_uris, client_secret, etc."><meta name=description content="Extending the Django OAuth Toolkit Application Model Mid-project"><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/>Mariatta</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#education>Education</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#recent-posts>Recent Posts</a>
<a class=dropdown-item href=/#publications>Recent Talks</a>
<a class=dropdown-item href=/#accomplishments>Accomplishments</a>
<a class=dropdown-item href=/#achievements>Highlights</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link href=/posts/talks/>My Talks</a></li><li class=nav-item><a class=nav-link href=/posts/ice_cream_selfies>Ice Cream Selfies</a></li><li class=nav-item><a class=nav-link href=/posts/typo_of_the_day>#TypoOfTheDay</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><a class="active list-link" href=/posts/extending-dj-oauth-toolkit-model/ title="Extending the Django OAuth Toolkit Application Model Mid-Project">Extending the Django OAuth Toolkit Application Model Mid-Project</a></li><li><a class=list-link href=/posts/how-to-thank-python-people/ title="How to Say Thanks to Python People">How to Say Thanks to Python People</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/> Ice Cream Selfies</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2016/> 2016</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2016/djangoconus_2016/ title="DjangoCon US 2016">DjangoCon US 2016</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2017/> 2017</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2017/pyconit_djangoconeu/ title="DjangoCon Europe, PyCon Italy 2017">DjangoCon Europe, PyCon Italy 2017</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2017/pycaribbean/ title="PyCaribbean 2017">PyCaribbean 2017</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2017/pyconau_2017/ title="PyCon AU 2017">PyCon AU 2017</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2017/pyconca/ title="PyCon Canada 2017">PyCon Canada 2017</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2017/pyconus_2017/ title="PyCon US 2017">PyCon US 2017</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2018/> 2018</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2018/djangoconus_2018/ title="DjangoCon US 2018">DjangoCon US 2018</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2018/nbpy_2018/ title="North Bay Python 2018">North Bay Python 2018</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2018/pyconus_2018/ title="PyCon US 2018">PyCon US 2018</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2019/> 2019</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2019/github_universe/ title="GitHub Universe 2019">GitHub Universe 2019</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2019/pybay/ title="PyBay 2019">PyBay 2019</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2019/pyconde/ title="PyCon DE 2019">PyCon DE 2019</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2019/pyconus_2019/ title="PyCon US 2019">PyCon US 2019</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2019/zapier/ title="Zapier Fall Retreat 2019">Zapier Fall Retreat 2019</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2020/> 2020</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2020/pycascades_2020/ title="PyCascades 2020">PyCascades 2020</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2020/pyconus_2020/ title="PyCon US">PyCon US</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2020/pyconau-pycontw/ title="PyConAU, PyConTW">PyConAU, PyConTW</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2020/seagl_pyconid_pyconpl/ title="SeaGL, PyConID, PyConPL">SeaGL, PyConID, PyConPL</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2021/> 2021</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2021/github_maintainer_summit/ title="GitHub Global Maintainer Summit 2021">GitHub Global Maintainer Summit 2021</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2021/pycascades_2021/ title="PyCascades 2021">PyCascades 2021</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2021/pycon-apac-2021/ title="PyCon APAC 2021">PyCon APAC 2021</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2021/pycon_belarus_2021/ title="PyCon Belarus 2021">PyCon Belarus 2021</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2021/pycon_us_2021/ title="PyCon US 2021">PyCon US 2021</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2022/> 2022</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2022/pyconcolombia_2022/ title="PyCon Colombia 2022">PyCon Colombia 2022</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2022/python_brasil_2023/ title="Python Brasil 2022">Python Brasil 2022</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2023/> 2023</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2023/nbpy_2023/ title="North Bay Python 2023">North Bay Python 2023</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2023/pycon_2023/ title="PyCon US 2023">PyCon US 2023</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2023/python_core_sprint_2023/ title="Python Core Sprint">Python Core Sprint</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ice_cream_selfies/2024/> 2024</a><ul><li><a class=list-link href=/posts/ice_cream_selfies/2024/pycascades_2024/ title="PyCascades 2024">PyCascades 2024</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2024/pycon_2024/ title="PyCon US 2024">PyCon US 2024</a></li><li><a class=list-link href=/posts/ice_cream_selfies/2024/pyohio/ title="PyOhio 2024">PyOhio 2024</a></li></ul></li></ul></li><li><a class=list-link href=/posts/pyladiescon-speaker-support/ title="PyLadiesCon Speaker Support">PyLadiesCon Speaker Support</a></li><li><a class=list-link href=/posts/python-core-sprint-2024-day-1/ title="Python Core Sprint 2024: Day 1">Python Core Sprint 2024: Day 1</a></li><li><a class=list-link href=/posts/python-core-sprint-2024-day-2/ title="Python Core Sprint 2024: Day 2">Python Core Sprint 2024: Day 2</a></li><li><a class=list-link href=/posts/python-core-sprint-2024-day-3/ title="Python Core Sprint 2024: Day 3">Python Core Sprint 2024: Day 3</a></li><li><a class=list-link href=/posts/speaker_bio/ title="Speaker Bio">Speaker Bio</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/talks/> Talks</a><ul><li><a class=list-link href=/posts/talks/contributing-to-python/ title="Contributing to Python">Contributing to Python</a></li><li><a class=list-link href=/posts/talks/dial-m-for-mentor/ title="Dial M For Mentor">Dial M For Mentor</a></li><li><a class=list-link href=/posts/talks/dont-be-a-robot-build-the-bot/ title="Don't Be a Robot; Build the Bot!">Don't Be a Robot; Build the Bot!</a></li><li><a class=list-link href=/posts/talks/intro_to_unit_test_and_ci/ title="Intro to Unit Testing and Continuous Integration">Intro to Unit Testing and Continuous Integration</a></li><li><a class=list-link href=/posts/talks/making-the-most-out-of-code-reviews/ title="Making The Most Out of Code Reviews">Making The Most Out of Code Reviews</a></li><li><a class=list-link href=/posts/talks/oops-i-became-an-open-source-maintainer/ title="Oops! I Became an Open Source Maintainer! 😱">Oops! I Became an Open Source Maintainer! 😱</a></li><li><a class=list-link href=/posts/talks/pep_talk/ title="PEP Talk">PEP Talk</a></li><li><a class=list-link href=/posts/talks/theres-an-api-for-that/ title="There's an API for That!">There's an API for That!</a></li><li><a class=list-link href=/posts/talks/what-is-a-python-core-dev/ title="What Is a Python Core Developer?">What Is a Python Core Developer?</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/typo_of_the_day/> #TypoOfTheDay</a><ul><li><a class=list-link href=/posts/typo_of_the_day/1pmryedoctorappointment/ title="1 Pm Rye Doctor Appointment">1 Pm Rye Doctor Appointment</a></li><li><a class=list-link href=/posts/typo_of_the_day/100codecoverage/ title="100$ Code Coverage 🤪">100$ Code Coverage 🤪</a></li><li><a class=list-link href=/posts/typo_of_the_day/100codecowerage/ title="100% Code Cowerage 😱">100% Code Cowerage 😱</a></li><li><a class=list-link href=/posts/typo_of_the_day/11ampdf/ title="11 Am Pdf">11 Am Pdf</a></li><li><a class=list-link href=/posts/typo_of_the_day/achievementunlucked/ title="Achievement Unlucked">Achievement Unlucked</a></li><li><a class=list-link href=/posts/typo_of_the_day/alchemyofsauce/ title="Alchemy Of Sauce">Alchemy Of Sauce</a></li><li><a class=list-link href=/posts/typo_of_the_day/asyncioruin/ title="Asyncio.Ruin() 😰">Asyncio.Ruin() 😰</a></li><li><a class=list-link href=/posts/typo_of_the_day/asynciou/ title=Asynciou>Asynciou</a></li><li><a class=list-link href=/posts/typo_of_the_day/backstab/ title="Backstab 😫">Backstab 😫</a></li><li><a class=list-link href=/posts/typo_of_the_day/bardcode/ title=Bardcode>Bardcode</a></li><li><a class=list-link href=/posts/typo_of_the_day/beerandbreakfast/ title="Beer And Breakfast">Beer And Breakfast</a></li><li><a class=list-link href=/posts/typo_of_the_day/betworth/ title="Bet Worth 🤑">Bet Worth 🤑</a></li><li><a class=list-link href=/posts/typo_of_the_day/bidetwheel/ title="Bidet_Wheel 😥">Bidet_Wheel 😥</a></li><li><a class=list-link href=/posts/typo_of_the_day/blackheck/ title="Black --Heck">Black --Heck</a></li><li><a class=list-link href=/posts/typo_of_the_day/bleakpoint/ title=Bleakpoint()>Bleakpoint()</a></li><li><a class=list-link href=/posts/typo_of_the_day/boocamp/ title="Boo Camp 👻">Boo Camp 👻</a></li><li><a class=list-link href=/posts/typo_of_the_day/breakpint/ title=Breakpint()>Breakpint()</a></li><li><a class=list-link href=/posts/typo_of_the_day/brotip/ title="Bro Tip">Bro Tip</a></li><li><a class=list-link href=/posts/typo_of_the_day/bumsintheoven/ title="bums in the oven">bums in the oven</a></li><li><a class=list-link href=/posts/typo_of_the_day/butbucket/ title=Butbucket>Butbucket</a></li><li><a class=list-link href=/posts/typo_of_the_day/callbank/ title=Callbank>Callbank</a></li><li><a class=list-link href=/posts/typo_of_the_day/canibooanappointmentwithyou/ title="Can I Boo An Appointment With You?">Can I Boo An Appointment With You?</a></li><li><a class=list-link href=/posts/typo_of_the_day/cashandcurry/ title="Cash And Curry">Cash And Curry</a></li><li><a class=list-link href=/posts/typo_of_the_day/changelong/ title=Changelong>Changelong</a></li><li><a class=list-link href=/posts/typo_of_the_day/clanchowder/ title="Clan Chowder">Clan Chowder</a></li><li><a class=list-link href=/posts/typo_of_the_day/collaboation/ title=Collaboation>Collaboation</a></li><li><a class=list-link href=/posts/typo_of_the_day/comadline/ title="Comad Line">Comad Line</a></li><li><a class=list-link href=/posts/typo_of_the_day/combibnation/ title=Combibnation>Combibnation</a></li><li><a class=list-link href=/posts/typo_of_the_day/cookingandfaking/ title="Cooking And Faking">Cooking And Faking</a></li><li><a class=list-link href=/posts/typo_of_the_day/coroutune/ title="Coroutune 🎶">Coroutune 🎶</a></li><li><a class=list-link href=/posts/typo_of_the_day/cutearelease/ title="Cute A Release">Cute A Release</a></li><li><a class=list-link href=/posts/typo_of_the_day/dangerours/ title=Dangerours>Dangerours</a></li><li><a class=list-link href=/posts/typo_of_the_day/datadoh/ title=Datadoh!>Datadoh!</a></li><li><a class=list-link href=/posts/typo_of_the_day/datavase/ title="Datavase 💐">Datavase 💐</a></li><li><a class=list-link href=/posts/typo_of_the_day/deadtivate/ title=Deadtivate>Deadtivate</a></li><li><a class=list-link href=/posts/typo_of_the_day/defendabot/ title="Defendabot 🤖🛡️">Defendabot 🤖🛡️</a></li><li><a class=list-link href=/posts/typo_of_the_day/demonstate/ title="Demonstate 😈">Demonstate 😈</a></li><li><a class=list-link href=/posts/typo_of_the_day/deplotment/ title=Deplotment>Deplotment</a></li><li><a class=list-link href=/posts/typo_of_the_day/deprecationwaning/ title=Deprecationwaning>Deprecationwaning</a></li><li><a class=list-link href=/posts/typo_of_the_day/detextive/ title=Detextive>Detextive</a></li><li><a class=list-link href=/posts/typo_of_the_day/devreel/ title=Devreel>Devreel</a></li><li><a class=list-link href=/posts/typo_of_the_day/diditgiveanyterrormessage/ title="Did it give any terror message? 😱😰">Did it give any terror message? 😱😰</a></li><li><a class=list-link href=/posts/typo_of_the_day/dimsim/ title="Dim Sim 🥟🥢">Dim Sim 🥟🥢</a></li><li><a class=list-link href=/posts/typo_of_the_day/discardserver/ title="Discard Server">Discard Server</a></li><li><a class=list-link href=/posts/typo_of_the_day/dockercompost/ title="Docker-Compost ♻️">Docker-Compost ♻️</a></li><li><a class=list-link href=/posts/typo_of_the_day/docsting/ title="Docsting 🐝">Docsting 🐝</a></li><li><a class=list-link href=/posts/typo_of_the_day/doctoring/ title="Doctoring, Instead Of Docstring... 👩‍⚕️❓💬🤔❌">Doctoring, Instead Of Docstring... 👩‍⚕️❓💬🤔❌</a></li><li><a class=list-link href=/posts/typo_of_the_day/docusigh/ title=Docusigh>Docusigh</a></li><li><a class=list-link href=/posts/typo_of_the_day/doofscrolling/ title=Doofscrolling>Doofscrolling</a></li><li><a class=list-link href=/posts/typo_of_the_day/dreadthedocs/ title="Dread The Docs 😨😣">Dread The Docs 😨😣</a></li><li><a class=list-link href=/posts/typo_of_the_day/duddate/ title="Dud Date">Dud Date</a></li><li><a class=list-link href=/posts/typo_of_the_day/executie/ title=Executie>Executie</a></li><li><a class=list-link href=/posts/typo_of_the_day/explodingkitchens/ title="Exploding Kitchens 💥">Exploding Kitchens 💥</a></li><li><a class=list-link href=/posts/typo_of_the_day/fearturerequest/ title="Fearture Request 😱👻">Fearture Request 😱👻</a></li><li><a class=list-link href=/posts/typo_of_the_day/feetback/ title=Feetback>Feetback</a></li><li><a class=list-link href=/posts/typo_of_the_day/flirtinstall/ title="Flirt Install 🤭">Flirt Install 🤭</a></li><li><a class=list-link href=/posts/typo_of_the_day/foodfirstissue/ title="Food First Issue">Food First Issue</a></li><li><a class=list-link href=/posts/typo_of_the_day/framewok/ title=Framewok>Framewok</a></li><li><a class=list-link href=/posts/typo_of_the_day/friendchicken/ title="Friend Chicken 😥🍗">Friend Chicken 😥🍗</a></li><li><a class=list-link href=/posts/typo_of_the_day/fromtypingimportnapping/ title="From Typing Import Napping">From Typing Import Napping</a></li><li><a class=list-link href=/posts/typo_of_the_day/pipinstallnoachedir/ title="from typing import Onion 🧅">from typing import Onion 🧅</a></li><li><a class=list-link href=/posts/typo_of_the_day/fullstuckdeveloper/ title="Full Stuck Developer">Full Stuck Developer</a></li><li><a class=list-link href=/posts/typo_of_the_day/funraising/ title=Funraising>Funraising</a></li><li><a class=list-link href=/posts/typo_of_the_day/ghostname/ title="Ghostname 👻">Ghostname 👻</a></li><li><a class=list-link href=/posts/typo_of_the_day/giftpush/ title="Gift Push ➡️🎁">Gift Push ➡️🎁</a></li><li><a class=list-link href=/posts/typo_of_the_day/gigcommit/ title="Gig Commit">Gig Commit</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitconfit/ title="Git Confit">Git Confit</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitfetchroigin/ title="Git Fetch Roigin">Git Fetch Roigin</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitgeekout/ title="Git Geekout ...">Git Geekout ...</a></li><li><a class=list-link href=/posts/typo_of_the_day/githush/ title="Git Hush">Git Hush</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitlol/ title="Git Lol 😜">Git Lol 😜</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitpushforcewithplease/ title="Git Push --Force-With-Please">Git Push --Force-With-Please</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitrebasemaim/ title="Git Rebase Maim">Git Rebase Maim</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitrebate/ title="Git Rebate">Git Rebate</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitresthard/ title="Git Rest --Hard">Git Rest --Hard</a></li><li><a class=list-link href=/posts/typo_of_the_day/githug/ title=Githug>Githug</a></li><li><a class=list-link href=/posts/typo_of_the_day/githuh/ title="Githuh 🤨">Githuh 🤨</a></li><li><a class=list-link href=/posts/typo_of_the_day/gitlamb/ title="Gitlamb 🐑">Gitlamb 🐑</a></li><li><a class=list-link href=/posts/typo_of_the_day/givingpeoplebuffetspace/ title="Giving People Buffet Space">Giving People Buffet Space</a></li><li><a class=list-link href=/posts/typo_of_the_day/goofiebag/ title="Goofie Bag 🤪🛍️">Goofie Bag 🤪🛍️</a></li><li><a class=list-link href=/posts/typo_of_the_day/googlecouldplatform/ title="Google Could Platform 🙊">Google Could Platform 🙊</a></li><li><a class=list-link href=/posts/typo_of_the_day/googlefarms/ title="Google Farms">Google Farms</a></li><li><a class=list-link href=/posts/typo_of_the_day/googleloudplatform/ title="Google Loud Platform ☁️🔊">Google Loud Platform ☁️🔊</a></li><li><a class=list-link href=/posts/typo_of_the_day/grrrpc/ title=Grrrpc>Grrrpc</a></li><li><a class=list-link href=/posts/typo_of_the_day/guidelies/ title="Guidelies 🤥">Guidelies 🤥</a></li><li><a class=list-link href=/posts/typo_of_the_day/gutstash/ title="Gut Stash">Gut Stash</a></li><li><a class=list-link href=/posts/typo_of_the_day/hackmad/ title=Hackmad>Hackmad</a></li><li><a class=list-link href=/posts/typo_of_the_day/haveagoatweekend/ title="Have A Goat Weekend! 🙊😅">Have A Goat Weekend! 🙊😅</a></li><li><a class=list-link href=/posts/typo_of_the_day/heardthroughthegripevine/ title="Heard Through The 'Gripevine' .... 🙊">Heard Through The 'Gripevine' .... 🙊</a></li><li><a class=list-link href=/posts/typo_of_the_day/heckout/ title=Heck-Out>Heck-Out</a></li><li><a class=list-link href=/posts/typo_of_the_day/homedeport/ title="Home Deport 😥">Home Deport 😥</a></li><li><a class=list-link href=/posts/typo_of_the_day/hoppot/ title="Hop Pot">Hop Pot</a></li><li><a class=list-link href=/posts/typo_of_the_day/httpdogspythonorg/ title=Http://Dogs.Python.Org>Http://Dogs.Python.Org</a></li><li><a class=list-link href=/posts/typo_of_the_day/httphugspythonorg/ title="Http://Hugs.Python.Org  🤗 ">Http://Hugs.Python.Org 🤗</a></li><li><a class=list-link href=/posts/typo_of_the_day/httpmanagepymigraine/ title="Http://Manage.Py Migraine">Http://Manage.Py Migraine</a></li><li><a class=list-link href=/posts/typo_of_the_day/hunkremoval/ title="Hunk Removal">Hunk Removal</a></li><li><a class=list-link href=/posts/typo_of_the_day/iwitchedthevideo/ title="I Witched The Video.. 🧙🏻‍♀️📺">I Witched The Video.. 🧙🏻‍♀️📺</a></li><li><a class=list-link href=/posts/typo_of_the_day/illtakealoserlook/ title="I'll take a loser look! 👀🙈">I'll take a loser look! 👀🙈</a></li><li><a class=list-link href=/posts/typo_of_the_day/icedream/ title="Ice Dream 🥶">Ice Dream 🥶</a></li><li><a class=list-link href=/posts/typo_of_the_day/icketinsteadofticket/ title="Icket Instead Of Ticket.">Icket Instead Of Ticket.</a></li><li><a class=list-link href=/posts/typo_of_the_day/ideadlly/ title=Ideadlly>Ideadlly</a></li><li><a class=list-link href=/posts/typo_of_the_day/importdaretime/ title="Import Daretime">Import Daretime</a></li><li><a class=list-link href=/posts/typo_of_the_day/importdatetie/ title="Import Datetie">Import Datetie</a></li><li><a class=list-link href=/posts/typo_of_the_day/importimdb/ title="Import Imdb">Import Imdb</a></li><li><a class=list-link href=/posts/typo_of_the_day/importlimb/ title=Importlimb>Importlimb</a></li><li><a class=list-link href=/posts/typo_of_the_day/inertview/ title=Inertview>Inertview</a></li><li><a class=list-link href=/posts/typo_of_the_day/ipdbsettrance/ title=Ipdb.Set_Trance()>Ipdb.Set_Trance()</a></li><li><a class=list-link href=/posts/typo_of_the_day/istherenaythingicanhelpwith/ title="Is There Naything I Can Help With?">Is There Naything I Can Help With?</a></li><li><a class=list-link href=/posts/typo_of_the_day/issuetrucker/ title="Issue Trucker 🚚">Issue Trucker 🚚</a></li><li><a class=list-link href=/posts/typo_of_the_day/itcanbesued/ title="It Can Be Sued 🙊">It Can Be Sued 🙊</a></li><li><a class=list-link href=/posts/typo_of_the_day/itwenttomyspasmfolder/ title="It Went To My Spasm Folder 🚮📧">It Went To My Spasm Folder 🚮📧</a></li><li><a class=list-link href=/posts/typo_of_the_day/jellosign/ title=Jellosign>Jellosign</a></li><li><a class=list-link href=/posts/typo_of_the_day/jsno/ title=Jsno>Jsno</a></li><li><a class=list-link href=/posts/typo_of_the_day/jsob/ title="Jsob 😢">Jsob 😢</a></li><li><a class=list-link href=/posts/typo_of_the_day/keynope/ title=Keynope>Keynope</a></li><li><a class=list-link href=/posts/typo_of_the_day/letmeknowiftheresabittermeetingtime/ title="Let Me Know If There'S A Bitter Meeting Time">Let Me Know If There'S A Bitter Meeting Time</a></li><li><a class=list-link href=/posts/typo_of_the_day/lickinsteadofclick/ title="Lick 👅 🖱️">Lick 👅 🖱️</a></li><li><a class=list-link href=/posts/typo_of_the_day/loopurnuntilcomplete/ title="loop.urn_until_complete() 🏺🔁">loop.urn_until_complete() 🏺🔁</a></li><li><a class=list-link href=/posts/typo_of_the_day/loveandorder/ title="Love And Order">Love And Order</a></li><li><a class=list-link href=/posts/typo_of_the_day/lovingroom/ title="Loving Room">Loving Room</a></li><li><a class=list-link href=/posts/typo_of_the_day/lowbroodpressure/ title="Low Brood Pressure">Low Brood Pressure</a></li><li><a class=list-link href=/posts/typo_of_the_day/macosbigsure/ title="Macos Big Sure">Macos Big Sure</a></li><li><a class=list-link href=/posts/typo_of_the_day/macosmobterey/ title="Macos Mobterey">Macos Mobterey</a></li><li><a class=list-link href=/posts/typo_of_the_day/mafiatta/ title="Mafiatta 😵">Mafiatta 😵</a></li><li><a class=list-link href=/posts/typo_of_the_day/mailinglost/ title="Mailing-Lost 📩❌">Mailing-Lost 📩❌</a></li><li><a class=list-link href=/posts/typo_of_the_day/maintainerd/ title=Maintainerd>Maintainerd</a></li><li><a class=list-link href=/posts/typo_of_the_day/mkdire/ title=Mkdire>Mkdire</a></li><li><a class=list-link href=/posts/typo_of_the_day/mobkeypatch/ title="Mobkey Patch">Mobkey Patch</a></li><li><a class=list-link href=/posts/typo_of_the_day/moneymoon/ title="Moneymoon 💸♥️">Moneymoon 💸♥️</a></li><li><a class=list-link href=/posts/typo_of_the_day/myphonynumberis/ title="My Phony Number Is ...">My Phony Number Is ...</a></li><li><a class=list-link href=/posts/typo_of_the_day/nailinglist/ title="Nailing List">Nailing List</a></li><li><a class=list-link href=/posts/typo_of_the_day/nodjs/ title=Nod.Js>Nod.Js</a></li><li><a class=list-link href=/posts/typo_of_the_day/nominstallnomstart/ title="nom install nom start">nom install nom start</a></li><li><a class=list-link href=/posts/typo_of_the_day/omenintech/ title="Omen In Tech 🙊😅">Omen In Tech 🙊😅</a></li><li><a class=list-link href=/posts/typo_of_the_day/omitmessage/ title="Omit Message">Omit Message</a></li><li><a class=list-link href=/posts/typo_of_the_day/onthetoad/ title="On The Toad 🐸🛣️">On The Toad 🐸🛣️</a></li><li><a class=list-link href=/posts/typo_of_the_day/onhoarding/ title=Onhoarding>Onhoarding</a></li><li><a class=list-link href=/posts/typo_of_the_day/onlone/ title=Onlone>Onlone</a></li><li><a class=list-link href=/posts/typo_of_the_day/oofsite/ title="Oofsite 😓">Oofsite 😓</a></li><li><a class=list-link href=/posts/typo_of_the_day/or/ title=OR>OR</a></li><li><a class=list-link href=/posts/typo_of_the_day/owever/ title=Owever...>Owever...</a></li><li><a class=list-link href=/posts/typo_of_the_day/painprogramming/ title="Pain Programming 🤕">Pain Programming 🤕</a></li><li><a class=list-link href=/posts/typo_of_the_day/paystun/ title=Paystun>Paystun</a></li><li><a class=list-link href=/posts/typo_of_the_day/paython/ title="Paython 🐍🤑">Paython 🐍🤑</a></li><li><a class=list-link href=/posts/typo_of_the_day/paytub/ title="Paytub 💵🪣">Paytub 💵🪣</a></li><li><a class=list-link href=/posts/typo_of_the_day/pep8complaint/ title="PEP 8-Complaint">PEP 8-Complaint</a></li><li><a class=list-link href=/posts/typo_of_the_day/peppeeve/ title="Pep Peeve">Pep Peeve</a></li><li><a class=list-link href=/posts/typo_of_the_day/fromtypingimportonion/ title="pip install --no-ache-dir 🤕">pip install --no-ache-dir 🤕</a></li><li><a class=list-link href=/posts/typo_of_the_day/podcats/ title="Podcats 🎙😺">Podcats 🎙😺</a></li><li><a class=list-link href=/posts/typo_of_the_day/poweroutrage/ title="Power Outrage">Power Outrage</a></li><li><a class=list-link href=/posts/typo_of_the_day/promotoe/ title=Promotoe>Promotoe</a></li><li><a class=list-link href=/posts/typo_of_the_day/protobluf/ title="Protobluf 🤪">Protobluf 🤪</a></li><li><a class=list-link href=/posts/typo_of_the_day/pupinstall/ title="Pup Install 🐶">Pup Install 🐶</a></li><li><a class=list-link href=/posts/typo_of_the_day/pycob/ title="Pycob 🌽">Pycob 🌽</a></li><li><a class=list-link href=/posts/typo_of_the_day/pypal/ title=Pypal>Pypal</a></li><li><a class=list-link href=/posts/typo_of_the_day/pytestmarkflay/ title=Pytest.Mark.Flay>Pytest.Mark.Flay</a></li><li><a class=list-link href=/posts/typo_of_the_day/pythonluggagesummit/ title="Python Luggage Summit 😅 ">Python Luggage Summit 😅</a></li><li><a class=list-link href=/posts/typo_of_the_day/pythonoredeveloper/ title="Python Ore Developer 👷‍♀️🐍">Python Ore Developer 👷‍♀️🐍</a></li><li><a class=list-link href=/posts/typo_of_the_day/pythontriadteam/ title="Python Triad Team 😰">Python Triad Team 😰</a></li><li><a class=list-link href=/posts/typo_of_the_day/pythonateutil/ title="Python-Ateutil 🍽🥢">Python-Ateutil 🍽🥢</a></li><li><a class=list-link href=/posts/typo_of_the_day/rakecare/ title="Rake Care">Rake Care</a></li><li><a class=list-link href=/posts/typo_of_the_day/repostories/ title=Repostories>Repostories</a></li><li><a class=list-link href=/posts/typo_of_the_day/rumserver/ title=Rumserver>Rumserver</a></li><li><a class=list-link href=/posts/typo_of_the_day/runthishellscript/ title="Run This Hell Script">Run This Hell Script</a></li><li><a class=list-link href=/posts/typo_of_the_day/saysauce/ title="Say Sauce.">Say Sauce.</a></li><li><a class=list-link href=/posts/typo_of_the_day/scipyfood/ title="Scipy Food 🌶">Scipy Food 🌶</a></li><li><a class=list-link href=/posts/typo_of_the_day/screenhot/ title="Screenhot 🖥🔥">Screenhot 🖥🔥</a></li><li><a class=list-link href=/posts/typo_of_the_day/seeyousono/ title="See You Sono">See You Sono</a></li><li><a class=list-link href=/posts/typo_of_the_day/shhkey/ title="Shh Key 🤫🔑">Shh Key 🤫🔑</a></li><li><a class=list-link href=/posts/typo_of_the_day/shutdownbuttheletternexttouonthekeyboard/ title="Shut Down, But The Letter Next To `U` On The Keyboard 🙊">Shut Down, But The Letter Next To `U` On The Keyboard 🙊</a></li><li><a class=list-link href=/posts/typo_of_the_day/sighups/ title=Sigh-Ups>Sigh-Ups</a></li><li><a class=list-link href=/posts/typo_of_the_day/skimpthedishes/ title="Skimp The Dishes 😥">Skimp The Dishes 😥</a></li><li><a class=list-link href=/posts/typo_of_the_day/snackpreview/ title="Snack Preview">Snack Preview</a></li><li><a class=list-link href=/posts/typo_of_the_day/snapsnot/ title=Snapsnot>Snapsnot</a></li><li><a class=list-link href=/posts/typo_of_the_day/sofaware/ title="Sofaware 🛋️">Sofaware 🛋️</a></li><li><a class=list-link href=/posts/typo_of_the_day/soundsgoof/ title="Sounds Goof 🤪">Sounds Goof 🤪</a></li><li><a class=list-link href=/posts/typo_of_the_day/sourceenvbibactivate/ title="source .env/bib/activate">source .env/bib/activate</a></li><li><a class=list-link href=/posts/typo_of_the_day/sponsorhip/ title=Sponsorhip>Sponsorhip</a></li><li><a class=list-link href=/posts/typo_of_the_day/spoonsor/ title="Spoonsor 🥄">Spoonsor 🥄</a></li><li><a class=list-link href=/posts/typo_of_the_day/spyladies/ title="Spyladies 🕵🏻‍♀️">Spyladies 🕵🏻‍♀️</a></li><li><a class=list-link href=/posts/typo_of_the_day/starfewvalley/ title="Starfew Valley 💫">Starfew Valley 💫</a></li><li><a class=list-link href=/posts/typo_of_the_day/starktrace/ title="Stark Trace">Stark Trace</a></li><li><a class=list-link href=/posts/typo_of_the_day/steakholde/ title=Steakholde>Steakholde</a></li><li><a class=list-link href=/posts/typo_of_the_day/storerage/ title=Storerage>Storerage</a></li><li><a class=list-link href=/posts/typo_of_the_day/strendcode/ title=Str.Endcode()>Str.Endcode()</a></li><li><a class=list-link href=/posts/typo_of_the_day/stripemall/ title="Stripe Mall">Stripe Mall</a></li><li><a class=list-link href=/posts/typo_of_the_day/sunscreenwithpsf30/ title="Sunscreen With Psf 30 🌞">Sunscreen With Psf 30 🌞</a></li><li><a class=list-link href=/posts/typo_of_the_day/tshirtwithoutther/ title="T-Shirt (Without The R) 😢😣🙊">T-Shirt (Without The R) 😢😣🙊</a></li><li><a class=list-link href=/posts/typo_of_the_day/tenplate/ title=Tenplate>Tenplate</a></li><li><a class=list-link href=/posts/typo_of_the_day/thanksforthehardworkyouvepunintothis/ title="Thanks For The Hard Work You'Ve Pun Into This">Thanks For The Hard Work You'Ve Pun Into This</a></li><li><a class=list-link href=/posts/typo_of_the_day/thanksforthequirkresponse/ title="Thanks for the quirk response!">Thanks for the quirk response!</a></li><li><a class=list-link href=/posts/typo_of_the_day/thebangofmyexistence/ title="The Bang Of My Existence">The Bang Of My Existence</a></li><li><a class=list-link href=/posts/typo_of_the_day/thinkyou/ title="Think You 💭">Think You 💭</a></li><li><a class=list-link href=/posts/typo_of_the_day/toadtrip/ title="Toad Trip 🐸">Toad Trip 🐸</a></li><li><a class=list-link href=/posts/typo_of_the_day/unitetest/ title="Unite Test">Unite Test</a></li><li><a class=list-link href=/posts/typo_of_the_day/unrademails/ title="Unrad Emails">Unrad Emails</a></li><li><a class=list-link href=/posts/typo_of_the_day/usermane/ title=Usermane>Usermane</a></li><li><a class=list-link href=/posts/typo_of_the_day/verbossitydebug/ title="verbossity debug">verbossity debug</a></li><li><a class=list-link href=/posts/typo_of_the_day/versionburp/ title="Version Burp">Version Burp</a></li><li><a class=list-link href=/posts/typo_of_the_day/wantonsoup/ title="Wanton Soup">Wanton Soup</a></li><li><a class=list-link href=/posts/typo_of_the_day/webshook/ title="Webshook 🤯 Instead Of Webhook">Webshook 🤯 Instead Of Webhook</a></li><li><a class=list-link href=/posts/typo_of_the_day/whichoneshouldisue/ title="Which One Should I Sue? 😨">Which One Should I Sue? 😨</a></li><li><a class=list-link href=/posts/typo_of_the_day/workliebalance/ title="Work-Lie Balance">Work-Lie Balance</a></li><li><a class=list-link href=/posts/typo_of_the_day/workglow/ title=Workglow>Workglow</a></li><li><a class=list-link href=/posts/typo_of_the_day/worklow/ title="Worklow 😔">Worklow 😔</a></li><li><a class=list-link href=/posts/typo_of_the_day/yourtalkwillbelivesteamed/ title="Your Talk Will Be Live Steamed ♨️">Your Talk Will Be Live Steamed ♨️</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/posts/sep2020.jpg)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/mariatta_hu5198731777375002455.png alt="Author Image"><h5 class=author-name>Mariatta</h5><p class=text-muted>Friday, August 30, 2024 | 6 minutes</p></div><div class=title><h1>Extending the Django OAuth Toolkit Application Model Mid-project</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/python/ class="btn btn-sm btn-info">Python</a></li><li class=rounded><a href=/tags/django/ class="btn btn-sm btn-info">Django</a></li><li class=rounded><a href=/tags/third-party-libraries/ class="btn btn-sm btn-info">Third Party Libraries</a></li><li class=rounded><a href=/tags/learnings/ class="btn btn-sm btn-info">Learnings</a></li><li class=rounded><a href=/tags/errors/ class="btn btn-sm btn-info">Errors</a></li><li class=rounded><a href=/tags/orm/ class="btn btn-sm btn-info">ORM</a></li><li class=rounded><a href=/tags/database/ class="btn btn-sm btn-info">Database</a></li></ul></div><div class=post-content id=post-content><h2 id=django-oauth-toolkit>Django Oauth Toolkit</h2><p>The <a href=https://django-oauth-toolkit.readthedocs.io/en/latest/index.html target=_blank rel=noopener>Django Oauth Toolkit</a> is a powerful library for
adding OAuth2 functionalities out of the box for your Django app.
The library comes with pre-defined models, views, urls, and templates for managing OAuth2 authorization and flow.</p><h2 id=the-application-model>The Application Model</h2><p>Django OAuth Toolkit provides a basic model for the OAuth2 Application, this is a model that represents a Client on
the Authorization server. It has fields like <code>client_id</code>, <code>user</code>, <code>redirect_uris</code>, <code>client_secret</code>, etc.</p><h2 id=extending-the-application-model>Extending the Application Model</h2><p>Perhaps you may need to extend the <code>Application</code> model with your own&rsquo;s custom fields. For example, as described in the Django
OAuth Toolkit documentation, you might want to add a logo to your Application, or adding a flag to agreeing to the
terms of use, etc.</p><p>It can be done by extending the <code>oauth2_provider.models.AbstractApplication</code>.</p><p>The key thing though, you must do this at the <strong>very beginning</strong> of your project, <strong>before</strong> you ran the initial <code>oauth2_provider</code>
migration step.</p><p>The documentation explains <a href=https://django-oauth-toolkit.readthedocs.io/en/latest/advanced_topics.html#AbstractApplication target=_blank rel=noopener>how to do this</a>.</p><ol><li><p>Create a new Custom Application:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> django.db <span style=color:#f92672>import</span> models
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> oauth2_provider.models <span style=color:#f92672>import</span> AbstractApplication
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyApplication</span>(AbstractApplication):
</span></span><span style=display:flex><span>    logo <span style=color:#f92672>=</span> models<span style=color:#f92672>.</span>ImageField()
</span></span><span style=display:flex><span>    agree <span style=color:#f92672>=</span> models<span style=color:#f92672>.</span>BooleanField()
</span></span></code></pre></div></li><li><p>Update the Django settings, add the <code>OAUTH2_PROVIDER_APPLICATION_MODEL</code> variable, pointing to the new custom app:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>OAUTH2_PROVIDER_APPLICATION_MODEL <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;your_app_name.MyApplication&#34;</span>
</span></span></code></pre></div></li><li><p>Creating new model means that you need to create the migration for it, by running:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python manage.py makemigrations your_app_name
</span></span></code></pre></div></li><li><p>Force the migration of your new model, ensuring it to be run before the <code>oauth2_provider</code> migrations.
Add to your app&rsquo;s migration file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>run_before <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;oauth2_provider&#34;</span>, <span style=color:#e6db74>&#34;0001_initial&#34;</span>),
</span></span><span style=display:flex><span>]
</span></span></code></pre></div></li><li><p>Run the django migration.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python manage.py migrate
</span></span></code></pre></div></li></ol><h2 id=extending-the-application-model-mid-project>Extending the Application Model mid-project</h2><p>As mentioned above, the documented way to use a custom <code>Application</code> model is by creating it at
the beginning of the project.</p><p>But, maybe you&rsquo;re using this library for the first time. You didn&rsquo;t know you&rsquo;d need a custom model.
You ended up just using the built-in model, deployed to production. Maybe much later in the development cycle, you then realized that you
need to extend it.</p><p>What if you need to create the new custom application model after the initial migration <code>oauth2_provider</code> has been run?</p><p>This is what happened in my client&rsquo;s project. We had a project going that&rsquo;s been using the built-in <code>Application</code> model,
however now the project requirement changed, and we needed to extend it.</p><p>When I tried swapping the <code>Application</code> model with a custom one, I got some errors when running the migration, or when using the token.</p><p>Here are some example error messages that we&rsquo;ve seen:</p><pre tabindex=0><code>Migration oauth2_provider.0001_initial is applied before its dependency
    your_app_name.0001_initial on database &#39;default&#39;.
</code></pre><pre tabindex=0><code>insert or update on table &#34;oauth2_provider_accesstoken&#34; violates foreign key constraint
    &#34;oauth2_provider_acce_application_id_b22886e1_fk_oauth2_pr&#34;
    DETAIL:  Key (application_id)=(3) is not present in table &#34;oauth2_provider_application&#34;.
</code></pre><h2 id=what-to-do-about-it>What to do about it</h2><p>When I first saw the message about a migration being applied before the dependency app, I thought, perhaps I could
just reset the migration, like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python manage.py migrate oauth2_provider zero
</span></span></code></pre></div><p>However, it didn&rsquo;t work, because the migration is not reversible.</p><p>After some trial and error, I found some workaround.</p><div class="alert danger"><span><i data-feather=alert-octagon></i></span>
<span><strong>Before you go ahead and copy-paste the snippets below, please read the aftermath first to understand the risks.</strong></span></div><p>Here&rsquo;s what happened in the end.</p><ul><li>Downtime.</li><li>Deployment stopped.</li><li>Co-workers complained about broken local environment.</li><li>Tables got dropped.</li><li>Existing OAuth apps got deleted.</li><li>Existing users needed to re-create their OAuth Applications. (And update their client id/secret, etc.)</li></ul><p>Not good. In my client&rsquo;s case, the users of the OAuth Applications are quite small, and rather internal, so the downtime
was something we could bear. This might not work for you, and perhaps, I mean, <strong>surely</strong> there&rsquo;s a better way to do it?</p><p>Anyway, here are the things I did, just in case you have the same problem we faced, and you want to proceed anyway.</p><ol><li><p>Make the code changes as mentioned above, ie. create the custom <code>Application</code> model, update the <code>settings</code>
file, set the <code>OAUTH2_PROVIDER_APPLICATION_MODEL</code> setting, create the migration file, and add the <code>run_before</code> step
to it. But, do not run the migration file. (Well you can run it, but you&rsquo;ll get an error, so it just won&rsquo;t work).</p></li><li><p>Go back to the model&rsquo;s migration file, and comment the code where it says <code>run_before</code>.</p><pre tabindex=0><code># run_before = [
#    (&#34;oauth2_provider&#34;, &#34;0001_initial&#34;),
# ]
</code></pre></li><li><p>Go back to the settings, and comment out the line for <code>OAUTH2_PROVIDER_APPLICATION_MODEL</code>.</p><pre tabindex=0><code># OAUTH2_PROVIDER_APPLICATION_MODEL = &#34;your_app_name.MyApplication&#34;
</code></pre></li><li><p>Revert the <code>oauth2_provider</code> migration using <code>--fake</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python manage.py migrate --fake oauth2_provider zero
</span></span></code></pre></div></li><li><p>Restore the changes from step 2. and 3. above. Eg uncomment the <code>run_before</code>, and the <code>OAUTH2_PROVIDER_APPLICATION_MODEL</code> lines.</p><p>Eg. make sure the code looks like this again:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>OAUTH2_PROVIDER_APPLICATION_MODEL <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;your_app_name.MyApplication&#34;</span>
</span></span></code></pre></div><p>and</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>run_before <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    (<span style=color:#e6db74>&#34;oauth2_provider&#34;</span>, <span style=color:#e6db74>&#34;0001_initial&#34;</span>),
</span></span><span style=display:flex><span>]
</span></span></code></pre></div></li><li><p>On the terminal, open Django dbshell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python manage.py dbshell
</span></span></code></pre></div></li><li><p>Inside the <code>dbshell</code>, drop the <code>oauth2_provider</code> tables.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>TABLE</span> oauth2_provider_accesstoken <span style=color:#66d9ef>CASCADE</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>TABLE</span> oauth2_provider_grant <span style=color:#66d9ef>CASCADE</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>TABLE</span> oauth2_provider_idtoken <span style=color:#66d9ef>CASCADE</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>TABLE</span> oauth2_provider_refreshtoken <span style=color:#66d9ef>CASCADE</span>;
</span></span></code></pre></div></li><li><p>Exit <code>dbshell</code>.</p><pre tabindex=0><code>\q
</code></pre></li><li><p>Now the Django migration can run without errors.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python manage.py migrate
</span></span></code></pre></div></li></ol><p>I did all the steps from 1 to 9 above, it worked for me locally. But now the trouble is, how to deploy such a change?</p><p>Here&rsquo;s what we end up doing. (which caused the deployment to stop, and co-workers &ldquo;complained&rdquo;).</p><p>I committed the code changes mentioned on step 1 (and then pushed, and merged the PR). This way my co-workers
(and the staging environment) received the code containing the new model and migration files.</p><p>Then I told them that they need to do steps 2-9 on their own. eg. ask them to comment
a few lines of code, drop their tables, and uncomment the codes again, and re-run their migration. I&rsquo;ve
included the documentation and step-by-step instructions just like the one I wrote above, and additionally offered
to pair program and help them resolve it.</p><p>We did this change on the staging environment too.
After making sure that the process worked like this on staging, (and after confirming that co-workers&rsquo; issues are resolved)
that&rsquo;s when we deployed to production and break the production for a few minutes.</p><h2 id=is-there-a-better-way-to-do-this>Is there a better way to do this?</h2><p>I&rsquo;m sure the way I did it is not the right way to fix it. Not everyone can afford such downtime.</p><p>If you know of a better way, please let me know, or update <a href=https://github.com/jazzband/django-oauth-toolkit/issues/669 target=_blank rel=noopener>the issue</a>.</p><p>I&rsquo;m wondering, perhaps the useful thing to do is to just always begin with a custom Application model from the get go. Right now,
the topic about extending the Application model is not mentioned in the &ldquo;Get Started&rdquo; documentation, but appears much later
under &ldquo;Advanced topics.&rdquo;</p><p>Perhaps the docs should recommend user to always create the custom Application, even if they don&rsquo;t need additional fields.</p><p>Perhaps it should be written in bold somewhere that &ldquo;using the built-in Application model means you can&rsquo;t change it down the road&rdquo;.</p><p>Anyway, thanks for reading, and I hope you find it useful.</p><h2 id=about-django-oauth-toolkit>About Django OAuth Toolkit</h2><ul><li>GitHub Repo: <a href=https://github.com/jazzband/django-oauth-toolkit target=_blank rel=noopener>https://github.com/jazzband/django-oauth-toolkit</a></li><li>Documentation: <a href=https://django-oauth-toolkit.readthedocs.io/en/latest/ target=_blank rel=noopener>https://django-oauth-toolkit.readthedocs.io/en/latest/</a></li><li>On PyPI: <a href=https://pypi.org/project/django-oauth-toolkit/ target=_blank rel=noopener>https://pypi.org/project/django-oauth-toolkit/</a></li><li>License: BSD License</li></ul></div><iframe src=https://github.com/sponsors/Mariatta/card title="Sponsor Mariatta" height=225 width=600 style=border:0></iframe><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fmariatta.ca%2fposts%2fextending-dj-oauth-toolkit-model%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fmariatta.ca%2fposts%2fextending-dj-oauth-toolkit-model%2f&text=Extending%20the%20Django%20OAuth%20Toolkit%20Application%20Model%20Mid-project&via=Mariatta" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fmariatta.ca%2fposts%2fextending-dj-oauth-toolkit-model%2f&title=Extending%20the%20Django%20OAuth%20Toolkit%20Application%20Model%20Mid-project" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fmariatta.ca%2fposts%2fextending-dj-oauth-toolkit-model%2f&title=Extending%20the%20Django%20OAuth%20Toolkit%20Application%20Model%20Mid-project" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-mastodon" href="https://mastodon.social/share?text=Extending%20the%20Django%20OAuth%20Toolkit%20Application%20Model%20Mid-project - https%3a%2f%2fmariatta.ca%2fposts%2fextending-dj-oauth-toolkit-model%2f" target=_blank><i class="fab fa-mastodon"></i>
</a><a class="btn icon-button" href="mailto:?subject=Extending%20the%20Django%20OAuth%20Toolkit%20Application%20Model%20Mid-project&body=https%3a%2f%2fmariatta.ca%2fposts%2fextending-dj-oauth-toolkit-model%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/how-to-thank-python-people/ title="How to Say Thanks to Python People" class="btn filled-button"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>How to Say Thanks to Python People</div></a></div></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="mariatta",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#django-oauth-toolkit>Django Oauth Toolkit</a></li><li><a href=#the-application-model>The Application Model</a></li><li><a href=#extending-the-application-model>Extending the Application Model</a></li><li><a href=#extending-the-application-model-mid-project>Extending the Application Model mid-project</a></li><li><a href=#what-to-do-about-it>What to do about it</a></li><li><a href=#is-there-a-better-way-to-do-this>Is there a better way to do this?</a></li><li><a href=#about-django-oauth-toolkit>About Django OAuth Toolkit</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#publications>Recent Talks</a></li><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#accomplishments>Accomplishments</a></li><li class=nav-item><a class=smooth-scroll href=https://mariatta.ca/#achievements>Highlights</a></li><li class=nav-item><a class=smooth-scroll href=/posts/talks/>My Talks</a></li><li class=nav-item><a class=smooth-scroll href=/posts/ice_cream_selfies>Ice Cream Selfies</a></li><li class=nav-item><a class=smooth-scroll href=/posts/typo_of_the_day>#TypoOfTheDay</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:mariatta@mariatta.ca target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>mariatta@mariatta.ca</span></a></li><li><a href=https://github.com/mariatta target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>mariatta</span></a></li><li><a href=https://www.linkedin.com/in/mariatta target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Mariatta</span></a></li><li><a href=https://fosstodon.org/@mariatta target=_blank rel=noopener><span><i class="fab fa-mastodon"></i></span> <span>@mariatta@fosstodon.org</span></a></li><li><a href=https://twitter.com/mariatta target=_blank rel=noopener><span><i class="fab fa-twitter"></i></span> <span>mariatta</span></a></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu16779671404603505019.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright, Mariatta.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.f7e14ace120e2f169cdd44c73cbafef2011b558aca3c03fbec818f92af34f849.js integrity="sha256-9+FKzhIOLxac3UTHPLr+8gEbVYrKPAP77IGPkq80+Ek=" defer></script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script><script>kofiWidgetOverlay.draw("mariatta",{type:"floating-chat","floating-chat.donateButton.text":"Tip Me","floating-chat.donateButton.text-color":"#f9fafc","floating-chat.donateButton.background-color":"#248aaa"})</script></body></html>